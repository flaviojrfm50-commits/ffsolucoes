<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Painel | Mercado</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Arial,sans-serif;
  background:#020617;
  color:#fff;
}
.topo{
  background:#0f172a;
  padding:18px 24px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.topo h2{margin:0}
.sair{
  background:#e53935;
  color:#fff;
  border:none;
  padding:10px 16px;
  border-radius:10px;
  cursor:pointer;
  font-weight:bold;
}

.container{
  max-width:900px;
  margin:40px auto;
  padding:20px;
}

.bemvindo{
  margin-bottom:30px;
  opacity:.9;
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
  gap:20px;
}

.card{
  background:#0f172a;
  padding:24px;
  border-radius:18px;
  cursor:pointer;
  transition:.2s;
}
.card:hover{
  background:#162033;
  transform:translateY(-3px);
}
.card h3{margin-top:0}
.card p{opacity:.8;font-size:14px}
</style>
</head>

<body>

<script>
/* 游댏 VALIDA SESS츾O */
const admin = JSON.parse(localStorage.getItem("admin_logado"));

if(!admin || admin.tipo !== "mercado"){
  window.location.replace("login.html");
  throw new Error("Sess칚o inv치lida");
}
</script>

<div class="topo">
  <h2>游 Admin Mercado</h2>
  <button class="sair" onclick="logout()">Sair</button>
</div>

<div class="container">
  <div class="bemvindo">
    <h3>Bem-vindo, <b id="nome"></b></h3>
    <p>Painel administrativo do mercado</p>
  </div>

  <div class="grid">
    <div class="card" onclick="go('admins.html')">
      <h3>游논 Administradores</h3>
      <p>Criar e gerenciar usu치rios do mercado</p>
    </div>

    <div class="card" onclick="go('produtos.html')">
      <h3>游닍 Produtos</h3>
      <p>Cadastrar e controlar estoque</p>
    </div>

    <div class="card" onclick="go('vendas.html')">
      <h3>游 Vendas</h3>
      <p>Registrar vendas no caixa</p>
    </div>

    <div class="card" onclick="go('relatorios.html')">
      <h3>游늵 Relat칩rios</h3>
      <p>Visualizar faturamento e vendas</p>
    </div>

    <!-- 游대 CHAVE DE VIRADA -->
    <div class="card" onclick="alternarPublico()">
      <h3>游대 Alternar Site P칰blico</h3>
      <p id="modoPublico">Modo atual: Cat치logo</p>
    </div>

    <!-- 游깴 ACESSAR SITE (J츼 EXISTIA) -->
    <div class="card" onclick="abrirSite()">
      <h3>游깴 Acessar Site</h3>
      <p>Abrir a p치gina p칰blica do mercado</p>
    </div>

    <!-- 丘뙖잺 CONFIGURAR SITE (AGORA SIM) -->
    <div class="card" onclick="go('config-site.html')">
      <h3>丘뙖잺 Configurar Site</h3>
      <p>Configura칞칫es da vitrine / cat치logo</p>
    </div>
  </div>
</div>

<script>
document.getElementById("nome").innerText = admin.usuario;

/* navega칞칚o interna */
function go(pagina){
  window.location.href = pagina;
}

/* estado inicial */
const modoInicial = localStorage.getItem("publico_modo") || "catalogo";
atualizarLabel(modoInicial);

/* alterna chave */
function alternarPublico(){
  const atual = localStorage.getItem("publico_modo") || "catalogo";
  const novo = atual === "catalogo" ? "site" : "catalogo";
  localStorage.setItem("publico_modo", novo);
  atualizarLabel(novo);
}

/* atualiza texto */
function atualizarLabel(modo){
  document.getElementById("modoPublico").innerText =
    modo === "site"
      ? "Modo atual: Site"
      : "Modo atual: Cat치logo";
}

/* abre conforme a chave */
function abrirSite(){
  const app = admin.app_id;
  const modo = localStorage.getItem("publico_modo") || "catalogo";

  const url =
    modo === "site"
      ? `../mercado/public/site.html?app=${app}`
      : `../mercado/public/catalogo.html?app=${app}`;

  window.open(url, "_blank");
}

/* logout */
function logout(){
  localStorage.removeItem("admin_logado");
  window.location.href = "login.html";
}
</script>

</body>
</html>
