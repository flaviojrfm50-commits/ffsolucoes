async function carregarPedido(){
  const { data: pedido } = await sb
    .from("pedidos")
    .select("id,status")
    .eq("app_id", appId)
    .eq("mesa_id", mesaId)
    .order("created_at", { ascending:false })
    .limit(1)
    .maybeSingle();

  // üîì PEDIDO ENCERRADO ‚Üí LIBERA MESA
  if(pedido && (pedido.status === "pago" || pedido.status === "finalizado")){
    pedidoAtual = null;
    document.getElementById("pedido").innerHTML = "<p>Nenhuma mesa ocupada</p>";
    document.getElementById("statusPedido").innerHTML = "";
    return;
  }

  // üîÅ PEDIDO ATIVO ‚Üí MANT√âM MESA OCUPADA
  if(pedido){
    pedidoAtual = pedido;
  } else {
    pedidoAtual = null;
    return;
  }

  renderStatus(pedido.status);

  const { data: itens } = await sb
    .from("pedido_itens")
    .select("id,nome_produto,quantidade")
    .eq("pedido_id", pedido.id)
    .eq("app_id", appId);

  const div = document.getElementById("pedido");
  div.innerHTML = "";

  if(!itens?.length){
    div.innerHTML = "<p>Nenhum item</p>";
    return;
  }

  itens.forEach(i=>{
    div.innerHTML += `
      <div class="item">
        <strong>${i.nome_produto}</strong>
        <div class="controls">
          <button onclick="alterarQtd('${i.id}',-1)">‚ûñ</button>
          <span>${i.quantidade}</span>
          <button onclick="alterarQtd('${i.id}',1)">‚ûï</button>
        </div>
      </div>
    `;
  });
}
