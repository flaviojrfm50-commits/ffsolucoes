<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Site Público</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
:root{
  --primary:#22c55e;
  --bg:#020617;
  --text:#ffffff;
  --muted:#94a3b8;
}
*{box-sizing:border-box;margin:0;padding:0;font-family:system-ui;}
body{background:var(--bg);color:var(--text);}

.hero{
  min-height:60vh;
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  padding:20px;
}
h1{font-size:2.4rem;}
p{color:var(--muted);margin-top:10px;}
</style>
</head>

<body>

<section class="hero">
  <div>
    <h1 id="titulo">Carregando…</h1>
    <p id="subtitulo">Site público</p>
  </div>
</section>

<script>
// ================= SUPABASE =================
const sb = supabase.createClient(
  "https://pdajixsoowcyhnjwhgpc.supabase.co",
  "sb_publishable_LatlFlcxk6IchHe3RNmfwA_9Oq4EsZw"
);

// ================= UUID DA URL =================
const params = new URLSearchParams(location.search);
let site_id = params.get("app_id");

// fallback UUID solto
if(!site_id){
  const raw = location.search.replace("?", "").split("&")[0];
  if(raw && raw.length >= 30) site_id = raw;
}

if(!site_id){
  document.getElementById("titulo").innerText = "Site não encontrado";
  throw new Error("UUID ausente");
}

// ================= LOAD SITE =================
(async()=>{
  const { data, error } = await sb
    .from("sites")
    .select("id, name")
    .eq("id", site_id)
    .maybeSingle();

  if(error || !data){
    document.getElementById("titulo").innerText = "Site indisponível";
    return;
  }

  document.getElementById("titulo").innerText = data.name;
})();
</script>

</body>
</html>
